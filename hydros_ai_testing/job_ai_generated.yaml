apiVersion: "example.com/v1"
kind: WorkloadIdentity
metadata:
  name: attach-gcp-sa-trainer
  annotations:
    owner.hydros.io/: "{\"hash\":\"f5faf45dba60ad4c4a91f2b3a6e592e59837d858d2f5f5ff7f9bb794290ad47c\",\"prompt\":\"“Attach the GCP service account trainer with GCS and BigQuery edit permissions. Create the service account if it doesn’t exist”\",\"response\":\"{\\\"id\\\":\\\"chatcmpl-7HKpmOxR6L3bkx09y2V9N3isMNhiB\\\",\\\"object\\\":\\\"chat.completion\\\",\\\"created\\\":1684366018,\\\"model\\\":\\\"gpt-3.5-turbo-0301\\\",\\\"choices\\\":[{\\\"index\\\":0,\\\"finish_reason\\\":\\\"stop\\\",\\\"message\\\":{\\\"role\\\":\\\"assistant\\\",\\\"content\\\":\\\"Here is the corresponding YAML definition for the given natural language description using the custom resource schema provided:\\\\n\\\\n```\\\\napiVersion: \\\\\\\"example.com/v1\\\\\\\"\\\\nkind: WorkloadIdentity\\\\nmetadata:\\\\n  name: attach-gcp-sa-trainer\\\\nspec:\\\\n  gsa:\\\\n    create: true\\\\n    name: trainer@myproject.iam.gserviceaccount.com\\\\n    iamBindings:\\\\n    - \\\\\\\"roles/storage.objectAdmin\\\\\\\"\\\\n    - \\\\\\\"roles/bigquery.dataEditor\\\\\\\"\\\\n  ksa:\\\\n    create: true\\\\n    name: trainer-sa\\\\n  requirement: \\\\\\\"Attach the GCP service account trainer with GCS and BigQuery edit permissions. Create the service account if it doesn't exist\\\\\\\"\\\\n```\\\\n\\\\nNote that the `apiVersion` and `kind` fields correspond to the custom resource schema provided in the prompt. In the `spec` section, we specify that we want to create a Google service account named `trainer@myproject.iam.gserviceaccount.com` and assign it the `roles/storage.objectAdmin` and `roles/bigquery.dataEditor` IAM roles. We also want to create a Kubernetes service account named `trainer-sa`. The `requirement` field is a natural language description of the resource's purpose.\\\"}}],\\\"usage\\\":{\\\"prompt_tokens\\\":465,\\\"completion_tokens\\\":250,\\\"total_tokens\\\":715}}\"}"
spec:
  gsa:
    name: trainer@myproject.iam.gserviceaccount.com
    create: true
    iamBindings:
    - "roles/storage.objectAdmin"
    - "roles/bigquery.dataEditor"
  ksa:
    name: trainer-sa
    create: true
  requirement: "Attach the GCP service account trainer with GCS and BigQuery edit permissions. Create the service account if it doesn't exist"
